syntax = "proto3";

import "github.com/gogo/protobuf/gogoproto/gogo.proto";

package commonpb;

option (gogoproto.goproto_enum_prefix_all) = false;
option (gogoproto.goproto_getters_all) = false;

enum EntryType {
  EntryInternal   = 0;
  EntryNormal     = 1;
  EntryConfChange = 2;
}

message Entry {
  uint64 term         = 1;
  uint64 index        = 2;
  EntryType entryType = 3;
  bytes data          = 4;
}

message Snapshot {
  uint64 leaderID = 1;

  uint64 term = 2;

  uint64 lastIncludedIndex = 3;
  uint64 lastIncludedTerm  = 4;

  bytes data   = 5;
}

enum ConfType {
  ConfAdd    = 0;
  ConfRemove = 1;
}

enum ConfStatus {
  ConfOK        = 0;
  ConfTimeout   = 2;
  ConfNotLeader = 3;
}

message ConfChangeRequest {
  uint64 serverID = 1;

  uint64 prevConf = 2;

  ConfType confType = 3;
}

message ConfChangeResponse {
  ConfStatus status = 1;

  string leaderHint = 2;
}